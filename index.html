<!DOCTYPE html>
<html lang="pt-br">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Luffy Boy</title>
    <style>
        @import url('https://fonts.googleapis.com/css2?family=Fredoka:wght@400;700&display=swap');

        body {
            display: flex;
            justify-content: center;
            align-items: center;
            height: 100vh;
            margin: 0;
            background-color: #f0e6e6;
            font-family: 'Fredoka', sans-serif;
            color: #4a4a4a;
            overflow: hidden;
            touch-action: manipulation; /* Previne o zoom da p√°gina no mobile */
        }

        .game-container {
            position: relative;
            width: 90vw;
            height: 90vh;
            max-width: 800px;
            max-height: 600px;
            border: 8px solid #8d6d6d;
            border-radius: 20px;
            box-shadow: 0 10px 20px rgba(0, 0, 0, 0.25);
            background-color: #f7f3f0;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            align-items: center;
        }

        canvas {
            border-radius: 10px;
            width: 100%;
            height: 100%;
        }

        .game-info {
            position: absolute;
            top: 20px;
            width: calc(100% - 40px);
            display: flex;
            justify-content: space-between;
            align-items: center;
            font-size: 1.2em;
            padding: 10px 20px;
            background: rgba(255, 255, 255, 0.7);
            border-radius: 10px;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            z-index: 10;
        }

        .game-info span {
            display: flex;
            align-items: center;
            white-space: nowrap;
        }

        .game-info .emoji {
            font-size: 1.5em;
            margin-right: 5px;
        }
        
        @media (max-width: 600px) {
            .game-info {
                flex-direction: column;
                padding: 10px;
            }
            .game-info span {
                margin-bottom: 5px;
            }
        }

        .screen {
            position: absolute;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            display: flex;
            flex-direction: column;
            justify-content: center;
            align-items: center;
            background-color: rgba(255, 255, 255, 0.95);
            z-index: 20;
            text-align: center;
            padding: 20px;
        }
        
        .screen h1 {
            font-size: 3em;
            margin-bottom: 20px;
            color: #4a4a4a;
            text-shadow: 2px 2px 4px rgba(0, 0, 0, 0.1);
        }

        .screen p {
            font-size: 1.2em;
            margin-bottom: 30px;
            color: #666;
            max-width: 80%;
        }
        
        .difficulty-options button {
            margin: 0 10px;
        }

        .play-button, .restart-button, .difficulty-button {
            padding: 15px 30px;
            font-size: 1.5em;
            background-color: #ff914d;
            color: white;
            border: none;
            border-radius: 30px;
            cursor: pointer;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            transition: transform 0.2s, background-color 0.2s;
        }

        .play-button:hover, .restart-button:hover, .difficulty-button:hover {
            background-color: #ff7d33;
            transform: scale(1.05);
        }

        .play-button:focus, .restart-button:focus, .difficulty-button:focus {
            outline: none;
            box-shadow: 0 0 0 4px #ff7d33, 0 4px 8px rgba(0, 0, 0, 0.2);
        }

        .play-button:disabled {
            background-color: #ccc;
            cursor: not-allowed;
            transform: none;
        }

        .instructions {
            margin-top: 20px;
            font-size: 0.9em;
            color: #888;
        }
        
        .luffy {
            font-size: 3em;
        }

        #win-image-container {
            font-size: 8em; /* Aumenta o tamanho dos emojis */
            margin-bottom: 20px;
        }

        /* Controles de toque para mobile */
        .controls {
            position: absolute;
            bottom: 20px;
            left: 50%;
            transform: translateX(-50%);
            display: flex; /* Usando flexbox para maior controle */
            justify-content: space-between;
            align-items: flex-end; /* Alinha os bot√µes na parte inferior */
            width: 90vw; 
            max-width: 400px;
            z-index: 15;
            flex-wrap: wrap; /* Permite que os bot√µes quebrem para a pr√≥xima linha se necess√°rio */
        }
        
        .control-button {
            width: 80px;
            height: 80px;
            border-radius: 15px;
            background-color: rgba(255, 255, 255, 0.5);
            border: 2px solid #8d6d6d;
            color: #4a4a4a;
            font-size: 2.5em;
            cursor: pointer;
            display: flex;
            justify-content: center;
            align-items: center;
            user-select: none;
            -webkit-user-select: none;
            transition: background-color 0.2s, box-shadow 0.2s;
        }
        
        .up-down-controls {
            display: flex;
            flex-direction: column;
            align-items: center;
            width: 100%;
            margin-top: 10px;
        }

        .side-controls {
            display: flex;
            justify-content: space-between;
            width: 100%;
        }
        
        .down-button {
            margin-bottom: 10px;
        }

        .control-button:active {
            background-color: rgba(255, 255, 255, 0.8);
        }
        
        .control-button:focus {
            outline: none;
            box-shadow: 0 0 0 4px #8d6d6d;
        }

        .control-instructions {
            text-align: center;
            margin-top: 10px;
            font-size: 0.8em;
            color: #888;
        }
    </style>
</head>
<body>

<div class="game-container">
    <div class="game-info">
        <span><span class="emoji">‚ù§Ô∏è</span> Vidas: <span id="lives">3</span></span>
        <span><span class="emoji">‚è±Ô∏è</span> Tempo: <span id="timer">30</span>s</span>
        <span><span class="emoji">‚≠ê</span> Pontua√ß√£o: <span id="score">0</span></span>
    </div>

    <div class="screen" id="start-screen">
        <h1>Luffy Boy</h1>
        <p>Ajude o Luffy a chegar nos bra√ßos do seu dono antes que o tempo acabe. Evite as pulgas, barras de chocolate e coleiras! Pegue os cora√ß√µes para se tornar imune e ganhar carinhos, e frango frito para ganhar pontos extras!</p>
        <div class="difficulty-options">
            <button class="difficulty-button" id="easy-button">F√°cil</button>
            <button class="difficulty-button" id="normal-button">Normal</button>
            <button class="difficulty-button" id="hard-button">Dif√≠cil</button>
        </div>
        <button class="play-button" id="play-button" style="display: none;">Jogar</button>
        <p class="instructions">Use as setas do teclado **ou os bot√µes de controle na tela** para mover o Luffy.</p>
    </div>

    <div class="screen" id="game-over-screen" style="display: none;">
        <h1>Game Over!</h1>
        <p id="game-over-message">Oh n√£o! Luffy ficou sem vidas...</p>
        <button class="restart-button" id="restart-button">Tentar de novo</button>
    </div>

    <div class="screen" id="win-screen" style="display: none;">
        <h1>Voc√™ Venceu!</h1>
        <div id="win-image-container">
            <span>üê∂‚ù§Ô∏èüë®‚Äçü¶±</span>
        </div>
        <p>Luffy est√° nos bra√ßos do seu dono. Que del√≠cia de carinho!</p>
        <button class="restart-button" id="win-restart-button">Jogar Novamente</button>
    </div>

    <canvas id="gameCanvas"></canvas>

    <!-- Controles para dispositivos de toque -->
    <div class="controls">
        <div class="side-controls">
            <button class="control-button left-button" id="left-button" aria-label="Mover para a esquerda">‚óÄ</button>
            <button class="control-button right-button" id="right-button" aria-label="Mover para a direita">‚ñ∂</button>
        </div>
        <div class="up-down-controls">
            <button class="control-button up-button" id="up-button" aria-label="Mover para cima">‚ñ≤</button>
            <button class="control-button down-button" id="down-button" aria-label="Mover para baixo">‚ñº</button>
        </div>
    </div>
</div>

<script>
    window.onload = function() {
        const canvas = document.getElementById('gameCanvas');
        const ctx = canvas.getContext('2d');
        const startScreen = document.getElementById('start-screen');
        const playButton = document.getElementById('play-button');
        const gameOverScreen = document.getElementById('game-over-screen');
        const winScreen = document.getElementById('win-screen');
        const restartButton = document.getElementById('restart-button');
        const winRestartButton = document.getElementById('win-restart-button');
        const livesSpan = document.getElementById('lives');
        const timerSpan = document.getElementById('timer');
        const scoreSpan = document.getElementById('score');
        const gameOverMessage = document.getElementById('game-over-message');
        const easyButton = document.getElementById('easy-button');
        const normalButton = document.getElementById('normal-button');
        const hardButton = document.getElementById('hard-button');

        // Bot√µes de controle de toque
        const upButton = document.getElementById('up-button');
        const downButton = document.getElementById('down-button');
        const leftButton = document.getElementById('left-button');
        const rightButton = document.getElementById('right-button');

        const GAME_DURATION = 30; // 30 segundos
        const PLAYER_SIZE = 40;
        const OBSTACLE_SIZE = 30;
        const HEART_SIZE = 25;
        const CHICKEN_SIZE = 30;

        let gameActive = false;
        let lives = 3;
        let score = 0;
        let immunityTime = 0;
        let timerInterval;
        let timeRemaining = GAME_DURATION;
        let difficulty = 'normal';
        let PUPPY_SPEED = 5;
        let OBSTACLE_BASE_SPEED = 1;
        let HEART_BASE_SPEED = 0.5;
        const SIDEWALK_HEIGHT = 80;

        // Posi√ß√£o do Luffy e do dono
        let luffy = {
            x: 0,
            y: 0, 
            dx: 0,
            dy: 0,
        };
        let owner = {
            x: 0,
            y: 30,
            width: 60,
            height: 60,
        };

        let obstacles = [];
        let hearts = [];
        let chickens = [];

        // Emojis para os elementos do jogo
        const luffyEmoji = 'üê∂';
        const ownerEmoji = 'üë®‚Äçü¶±';
        const obstaclesEmoji = ['ü™∞', 'üç´', 'ü¶Æ', 'ÔøΩ', 'üèçÔ∏è'];
        const heartEmoji = 'üíñ';
        const chickenEmoji = 'üçó';

        // Redimensionar o canvas para preencher o cont√™iner
        function resizeCanvas() {
            canvas.width = canvas.parentElement.clientWidth;
            canvas.height = canvas.parentElement.clientHeight;
            luffy.x = canvas.width / 2;
            luffy.y = canvas.height - SIDEWALK_HEIGHT - 30;
            owner.x = canvas.width / 2;
        }

        // Desenhar os elementos na tela
        function draw() {
            ctx.clearRect(0, 0, canvas.width, canvas.height);
            
            // Desenha o gramado
            ctx.fillStyle = '#8BC34A';
            ctx.fillRect(0, 0, canvas.width, canvas.height);
            
            // Desenha a cal√ßada na parte inferior
            ctx.fillStyle = '#bdbdbd';
            ctx.fillRect(0, canvas.height - SIDEWALK_HEIGHT, canvas.width, SIDEWALK_HEIGHT);

            // Desenhar o dono
            ctx.font = `${owner.width}px Arial`;
            ctx.textAlign = 'center';
            ctx.fillText(ownerEmoji, owner.x, owner.y);

            // Desenhar o Luffy
            ctx.font = `${PLAYER_SIZE}px Arial`;
            ctx.textAlign = 'center';
            if (immunityTime > 0) {
                ctx.globalAlpha = 0.5; // Efeito de imune
            }
            ctx.fillText(luffyEmoji, luffy.x, luffy.y);
            ctx.globalAlpha = 1.0;

            // Desenhar os obst√°culos
            ctx.font = `${OBSTACLE_SIZE}px Arial`;
            obstacles.forEach(obstacle => {
                ctx.fillText(obstacle.emoji, obstacle.x, obstacle.y);
            });

            // Desenhar os cora√ß√µes
            ctx.font = `${HEART_SIZE}px Arial`;
            hearts.forEach(heart => {
                ctx.fillText(heartEmoji, heart.x, heart.y);
            });

            // Desenhar os frangos fritos
            ctx.font = `${CHICKEN_SIZE}px Arial`;
            chickens.forEach(chicken => {
                ctx.fillText(chickenEmoji, chicken.x, chicken.y);
            });
        }

        // Atualizar a posi√ß√£o do Luffy
        function update() {
            if (!gameActive) return;

            // Mover Luffy
            luffy.x += luffy.dx * PUPPY_SPEED;
            luffy.y += luffy.dy * PUPPY_SPEED;

            // Limitar o movimento do Luffy dentro da tela (agora com a cal√ßada)
            const minX = PLAYER_SIZE / 2;
            const maxX = canvas.width - PLAYER_SIZE / 2;
            const minY = PLAYER_SIZE / 2;
            const maxY = canvas.height - SIDEWALK_HEIGHT - PLAYER_SIZE / 2;
            
            if (luffy.x < minX) luffy.x = minX;
            if (luffy.x > maxX) luffy.x = maxX;
            if (luffy.y < minY) luffy.y = minY;
            if (luffy.y > maxY) luffy.y = maxY;
            
            // Mover obst√°culos e itens
            obstacles.forEach(obstacle => {
                obstacle.y += obstacle.speed;
            });
            hearts.forEach(heart => {
                heart.y += heart.speed;
            });
            chickens.forEach(chicken => {
                chicken.y += chicken.speed;
            });
            
            // Remover elementos que sa√≠ram da tela
            obstacles = obstacles.filter(obstacle => obstacle.y < canvas.height + OBSTACLE_SIZE);
            hearts = hearts.filter(heart => heart.y < canvas.height + HEART_SIZE);
            chickens = chickens.filter(chicken => chicken.y < canvas.height + CHICKEN_SIZE);

            checkCollisions();
            checkWin();
            draw();
            requestAnimationFrame(update);
        }

        // Checar colis√µes
        function checkCollisions() {
            // Colis√£o com obst√°culos
            obstacles.forEach((obstacle, index) => {
                const distance = Math.sqrt(Math.pow(luffy.x - obstacle.x, 2) + Math.pow(luffy.y - obstacle.y, 2));
                const minDistance = (PLAYER_SIZE / 2) + (OBSTACLE_SIZE / 2);

                if (distance < minDistance) {
                    if (immunityTime <= 0) { // S√≥ perde vida se n√£o estiver imune
                        lives--;
                        livesSpan.textContent = lives;
                        obstacles.splice(index, 1);
                        if (lives <= 0) {
                            endGame(false, "Oh n√£o! Luffy ficou sem vidas...");
                        }
                    } else {
                        score += 10; // Ganha pontos por ser imune e passar
                        scoreSpan.textContent = score;
                        obstacles.splice(index, 1);
                    }
                }
            });

            // Colis√£o com cora√ß√µes
            hearts.forEach((heart, index) => {
                const distance = Math.sqrt(Math.pow(luffy.x - heart.x, 2) + Math.pow(luffy.y - heart.y, 2));
                const minDistance = (PLAYER_SIZE / 2) + (HEART_SIZE / 2);

                if (distance < minDistance) {
                    immunityTime = 5; // 5 segundos de imunidade
                    score += 50; // Ganha pontos por pegar o cora√ß√£o
                    scoreSpan.textContent = score;
                    hearts.splice(index, 1);
                }
            });

            // Colis√£o com frango frito
            chickens.forEach((chicken, index) => {
                const distance = Math.sqrt(Math.pow(luffy.x - chicken.x, 2) + Math.pow(luffy.y - chicken.y, 2));
                const minDistance = (PLAYER_SIZE / 2) + (CHICKEN_SIZE / 2);

                if (distance < minDistance) {
                    score += 100; // Pontos extras
                    scoreSpan.textContent = score;
                    chickens.splice(index, 1);
                }
            });


            if (immunityTime > 0) {
                immunityTime -= 1 / 60; // Reduzir o tempo de imunidade (aprox. 60 fps)
            }
        }

        // Checar se o jogador venceu ou perdeu ao final do tempo
        function checkWin() {
            if (timeRemaining <= 0) {
                if (lives > 0) {
                    endGame(true); // Vence se o tempo acabar com vidas
                } else {
                    endGame(false, "O tempo acabou! Luffy n√£o conseguiu chegar a tempo...");
                }
            }
        }

        // Iniciar o jogo
        function startGame() {
            startScreen.style.display = 'none';
            gameOverScreen.style.display = 'none';
            winScreen.style.display = 'none';
            gameActive = true;
            lives = 3;
            score = 0;
            timeRemaining = GAME_DURATION;
            livesSpan.textContent = lives;
            timerSpan.textContent = timeRemaining;
            scoreSpan.textContent = score;
            luffy = {
                x: canvas.width / 2,
                y: canvas.height - SIDEWALK_HEIGHT - 30,
                dx: 0,
                dy: 0,
            };
            obstacles = [];
            hearts = [];
            chickens = [];
            
            timerInterval = setInterval(() => {
                timeRemaining--;
                timerSpan.textContent = timeRemaining;
                if (timeRemaining <= 0) {
                    checkWin();
                }
            }, 1000);

            // Criar obst√°culos e itens periodicamente
            setInterval(spawnObstacle, 1000 / OBSTACLE_BASE_SPEED);
            setInterval(spawnHeart, 5000 / HEART_BASE_SPEED);
            setInterval(spawnChicken, 7000 / HEART_BASE_SPEED);

            requestAnimationFrame(update);
        }

        // Finalizar o jogo
        function endGame(didWin, message = "") {
            gameActive = false;
            clearInterval(timerInterval);

            if (didWin) {
                winScreen.style.display = 'flex';
            } else {
                gameOverScreen.style.display = 'flex';
                gameOverMessage.textContent = message;
            }
        }

        // Gerar um novo obst√°culo
        function spawnObstacle() {
            if (!gameActive) return;
            const emoji = obstaclesEmoji[Math.floor(Math.random() * obstaclesEmoji.length)];
            const x = Math.random() * (canvas.width - OBSTACLE_SIZE) + OBSTACLE_SIZE / 2;
            const speed = Math.random() * OBSTACLE_BASE_SPEED * 2 + OBSTACLE_BASE_SPEED;
            obstacles.push({ x: x, y: 0, speed: speed, emoji: emoji });
        }
        
        // Gerar um novo cora√ß√£o
        function spawnHeart() {
            if (!gameActive) return;
            const x = Math.random() * (canvas.width - HEART_SIZE) + HEART_SIZE / 2;
            const speed = Math.random() * HEART_BASE_SPEED * 2 + HEART_BASE_SPEED;
            hearts.push({ x: x, y: 0, speed: speed });
        }

        // Gerar um novo frango frito
        function spawnChicken() {
            if (!gameActive) return;
            const x = Math.random() * (canvas.width - CHICKEN_SIZE) + CHICKEN_SIZE / 2;
            const speed = Math.random() * HEART_BASE_SPEED * 2 + HEART_BASE_SPEED;
            chickens.push({ x: x, y: 0, speed: speed });
        }

        // Definir a dificuldade
        function setDifficulty(level) {
            difficulty = level;
            switch(level) {
                case 'easy':
                    PUPPY_SPEED = 6;
                    OBSTACLE_BASE_SPEED = 1;
                    HEART_BASE_SPEED = 0.5;
                    break;
                case 'normal':
                    PUPPY_SPEED = 5;
                    OBSTACLE_BASE_SPEED = 1.5;
                    HEART_BASE_SPEED = 0.75;
                    break;
                case 'hard':
                    PUPPY_SPEED = 3;
                    OBSTACLE_BASE_SPEED = 4;
                    HEART_BASE_SPEED = 2;
                    break;
            }
            // Ocultar os bot√µes de dificuldade e mostrar o bot√£o de jogar
            document.querySelectorAll('.difficulty-button').forEach(btn => btn.style.display = 'none');
            playButton.style.display = 'block';
        }

        // Eventos do teclado
        document.addEventListener('keydown', (e) => {
            if (!gameActive) return;
            switch (e.key) {
                case 'ArrowUp':
                    luffy.dy = -1;
                    break;
                case 'ArrowDown':
                    luffy.dy = 1;
                    break;
                case 'ArrowLeft':
                    luffy.dx = -1;
                    break;
                case 'ArrowRight':
                    luffy.dx = 1;
                    break;
            }
        });

        document.addEventListener('keyup', (e) => {
            if (!gameActive) return;
            switch (e.key) {
                case 'ArrowUp':
                case 'ArrowDown':
                    luffy.dy = 0;
                    break;
                case 'ArrowLeft':
                case 'ArrowRight':
                    luffy.dx = 0;
                    break;
            }
        });

        // Eventos de toque para os bot√µes do D-pad
        upButton.addEventListener('touchstart', (e) => { e.preventDefault(); luffy.dy = -1; });
        downButton.addEventListener('touchstart', (e) => { e.preventDefault(); luffy.dy = 1; });
        leftButton.addEventListener('touchstart', (e) => { e.preventDefault(); luffy.dx = -1; });
        rightButton.addEventListener('touchstart', (e) => { e.preventDefault(); luffy.dx = 1; });

        upButton.addEventListener('touchend', (e) => { e.preventDefault(); luffy.dy = 0; });
        downButton.addEventListener('touchend', (e) => { e.preventDefault(); luffy.dy = 0; });
        leftButton.addEventListener('touchend', (e) => { e.preventDefault(); luffy.dx = 0; });
        rightButton.addEventListener('touchend', (e) => { e.preventDefault(); luffy.dx = 0; });
        
        // Eventos de mouse para os bot√µes (para desktop, caso o usu√°rio n√£o tenha teclado)
        upButton.addEventListener('mousedown', () => { luffy.dy = -1; });
        downButton.addEventListener('mousedown', () => { luffy.dy = 1; });
        leftButton.addEventListener('mousedown', () => { luffy.dx = -1; });
        rightButton.addEventListener('mousedown', () => { luffy.dx = 1; });

        upButton.addEventListener('mouseup', () => { luffy.dy = 0; });
        downButton.addEventListener('mouseup', () => { luffy.dy = 0; });
        leftButton.addEventListener('mouseup', () => { luffy.dx = 0; });
        rightButton.addEventListener('mouseup', () => { luffy.dx = 0; });

        // Bot√µes de controle
        easyButton.addEventListener('click', () => setDifficulty('easy'));
        normalButton.addEventListener('click', () => setDifficulty('normal'));
        hardButton.addEventListener('click', () => setDifficulty('hard'));
        playButton.addEventListener('click', startGame);
        restartButton.addEventListener('click', startGame);
        winRestartButton.addEventListener('click', startGame);

        window.addEventListener('resize', () => {
            resizeCanvas();
            draw(); // Chame draw ap√≥s redimensionar para redesenhar o personagem
        });
        resizeCanvas();
        draw(); // Chamada inicial para desenhar o Luffy na tela de in√≠cio
    };
</script>

</body>
</html>
ÔøΩ
